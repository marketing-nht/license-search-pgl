<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PGL Procedure Lookup v2.0</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Inter', sans-serif; background-color: #f8fafc; }
    .animate-fadeIn { animation: fadeIn 0.3s ease-out forwards; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
    ::-webkit-scrollbar { width: 6px; }
    ::-webkit-scrollbar-track { background: transparent; }
    ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
    .step-line::before { content: ''; position: absolute; top: 0; bottom: 0; left: 15px; width: 2px; background: #e2e8f0; z-index: 0; }
  </style>
  <script type="importmap">
  {
    "imports": {
      "react": "https://esm.sh/react@18.2.0",
      "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
      "lucide-react": "https://esm.sh/lucide-react@0.294.0",
      "htm": "https://esm.sh/htm@3.1.1"
    }
  }
  </script>
</head>
<body>
  <div id="root"></div>

  <script type="module">
    import React, { useState, useMemo } from 'react';
    import ReactDOM from 'react-dom/client';
    import { Search, FileText, CheckCircle, AlertTriangle, Shield, Zap, Wifi, ChevronDown, ChevronUp, BookOpen, Layers } from 'lucide-react';
    import htm from 'htm';
    const html = htm.bind(React.createElement);

    // ==========================================
    // DỮ LIỆU THỦ TỤC CHI TIẾT (FULL DATA)
    // ==========================================
    const PROCEDURES = [
      // --- NHÓM 1: THIẾT BỊ CNTT (LAPTOP, TABLET...) ---
      {
        id: "laptop",
        name: "Máy tính xách tay (Laptop)",
        group: "CNTT & Viễn thông",
        scope: "Laptop, Notebook, máy tính 2-trong-1 (HS: 8471.30.20)",
        ministries: ["BỘ TTTT (MIC)", "BỘ CÔNG THƯƠNG (MOIT)"],
        standards: [
          { field: "Hiệu suất năng lượng", code: "TCVN 11848:2021", note: "Bắt buộc dán nhãn" },
          { field: "Tương thích điện từ (EMC)", code: "QCVN 118:2018/BTTTT", note: "Bắt buộc" },
          { field: "An toàn điện", code: "QCVN 132:2022/BTTTT", note: "Bắt buộc từ 01/01/2024" },
          { field: "Vô tuyến (Wifi/BT)", code: "QCVN 54, QCVN 65", note: "Nếu có tích hợp" },
          { field: "Pin Lithium", code: "QCVN 101:2020/BTTTT", note: "Cho pin bên trong" }
        ],
        steps: [
          { phase: "Giai đoạn 1: Thử nghiệm (Tại PGL)", desc: "Gửi mẫu thử nghiệm An toàn, EMC, RF và Hiệu suất năng lượng." },
          { phase: "Giai đoạn 2: Thủ tục Bộ Công Thương", desc: "Lập hồ sơ công bố dán nhãn năng lượng (Online). Doanh nghiệp tự dán nhãn sau khi công bố." },
          { phase: "Giai đoạn 3: Thủ tục Bộ TTTT", desc: "Đo kiểm -> Chứng nhận Hợp quy (Cục Viễn thông) -> Công bố Hợp quy -> Dán tem ICT." }
        ]
      },
      {
        id: "tablet",
        name: "Máy tính bảng (Tablet)",
        group: "CNTT & Viễn thông",
        scope: "Máy tính bảng (HS: 8471.30.90). Không bao gồm máy đọc sách.",
        ministries: ["BỘ TTTT (MIC)", "BỘ CÔNG THƯƠNG (MOIT)"],
        standards: [
          { field: "Hiệu suất năng lượng", code: "TCVN 11848:2021", note: "Bắt buộc dán nhãn" },
          { field: "An toàn điện", code: "QCVN 132:2022/BTTTT", note: "An toàn cho thiết bị CNTT" },
          { field: "Vô tuyến (Wifi/4G)", code: "QCVN 54, 65, 117", note: "Tùy module tích hợp" },
          { field: "SAR (Hấp thụ)", code: "QCVN 134:2024", note: "Nếu sử dụng sát người (<20cm)" }
        ],
        steps: [
          { phase: "Giai đoạn 1: Thử nghiệm", desc: "Đo kiểm toàn diện các chỉ tiêu tại phòng Lab được chỉ định (PGL)." },
          { phase: "Giai đoạn 2: Chứng nhận & Công bố", desc: "Chứng nhận Hợp quy (cho phần RF) và Công bố Hợp quy (cho phần An toàn/EMC)." },
          { phase: "Giai đoạn 3: Dán nhãn", desc: "Dán nhãn năng lượng (Bộ Công Thương) và Tem hợp quy ICT (Bộ TTTT)." }
        ]
      },
      {
        id: "mobile",
        name: "Điện thoại di động",
        group: "CNTT & Viễn thông",
        scope: "Điện thoại mặt đất, Smartphone (HS: 8517.12.00)",
        ministries: ["BỘ TTTT (MIC)"],
        standards: [
          { field: "RF (2G/3G/4G/5G)", code: "QCVN 117, 127, 129", note: "Lưu ý lộ trình tắt sóng 2G" },
          { field: "Wifi / Bluetooth", code: "QCVN 54, 65", note: "2.4GHz & 5GHz" },
          { field: "An toàn & EMC", code: "QCVN 132, 18, 86", note: "An toàn điện & Tương thích điện từ" },
          { field: "SAR (Mức hấp thụ)", code: "QCVN 134:2024", note: "Bắt buộc thử nghiệm SAR" },
          { field: "Pin Lithium", code: "QCVN 101:2020", note: "Thử an toàn Pin" }
        ],
        steps: [
          { phase: "Bước 1: Đo kiểm", desc: "Thử nghiệm tất cả các quy chuẩn tại PGL." },
          { phase: "Bước 2: Chứng nhận Hợp quy", desc: "Nộp hồ sơ tại Trung tâm Kiểm định và Chứng nhận (Cục Viễn thông)." },
          { phase: "Bước 3: Công bố & Dán tem", desc: "Công bố hợp quy và dán tem ICT lên sản phẩm." }
        ]
      },
      {
        id: "desktop",
        name: "Máy tính để bàn (Desktop)",
        group: "CNTT & Viễn thông",
        scope: "Máy tính cá nhân để bàn (HS: 8471.41.10)",
        ministries: ["BỘ CÔNG THƯƠNG", "BỘ TTTT"],
        standards: [
          { field: "Hiệu suất năng lượng", code: "TCVN 13371:2021", note: "Dán nhãn năng lượng" },
          { field: "EMC", code: "QCVN 118:2018/BTTTT", note: "Tự công bố" },
          { field: "Wifi (Nếu có)", code: "QCVN 54, 65", note: "Nếu tích hợp card wifi" }
        ],
        steps: [
          { phase: "Bước 1: Thử nghiệm", desc: "Thử nghiệm HSNL và EMC." },
          { phase: "Bước 2: Công bố", desc: "Công bố dán nhãn năng lượng (Bộ Công Thương) và Tự công bố hợp quy EMC (Sở TTTT)." }
        ]
      },

      // --- NHÓM 2: GIA DỤNG (ĐIỀU HÒA, TỦ LẠNH...) ---
      {
        id: "ac",
        name: "Điều hòa không khí",
        group: "Gia dụng & Năng lượng",
        scope: "Không ống gió, 1 cục hoặc 2 cục, Công suất lạnh <= 12.000W (41.000 BTU).",
        ministries: ["BỘ KHCN (MOST)", "BỘ CÔNG THƯƠNG (MOIT)"],
        standards: [
          { field: "EMC (Nhiễu từ)", code: "QCVN 9:2012/BKHCN", note: "Chứng nhận Hợp quy (CR)" },
          { field: "Hiệu suất năng lượng", code: "TCVN 7830:2021", note: "Cấp sao năng lượng (1-5 sao)" },
          { field: "An toàn điện", code: "TCVN 5699-2-40", note: "Thử nghiệm an toàn (LVD)" }
        ],
        steps: [
          { phase: "Bước 1: Kiểm tra chất lượng", desc: "Đăng ký kiểm tra nhà nước (trên Một cửa quốc gia) khi nhập khẩu." },
          { phase: "Bước 2: Thử nghiệm", desc: "Gửi mẫu thử EMC và HSNL tại Phúc Gia Lab." },
          { phase: "Bước 3: Chứng nhận & Dán nhãn", desc: "Cấp giấy Chứng nhận Hợp quy (CR) -> Thông quan. Sau đó dán nhãn năng lượng." }
        ]
      },
      {
        id: "fridge",
        name: "Tủ lạnh & Tủ đông",
        group: "Gia dụng & Năng lượng",
        scope: "Tủ lạnh, tủ kết đông, tủ mát. Dung tích <= 500L (bắt buộc) hoặc > 500L.",
        ministries: ["BỘ KHCN", "BỘ CÔNG THƯƠNG"],
        standards: [
          { field: "EMC", code: "QCVN 9:2012/BKHCN", note: "Chứng nhận CR" },
          { field: "Hiệu suất năng lượng", code: "TCVN 7828:2016", note: "Dán nhãn năng lượng" },
          { field: "An toàn", code: "TCVN 5699-2-24", note: "IEC 60335-2-24" }
        ],
        steps: [
          { phase: "Quy trình nhập khẩu", desc: "Đăng ký KTNN -> Thử nghiệm -> Chứng nhận Hợp quy -> Thông quan." },
          { phase: "Quy trình lưu thông", desc: "Dán tem CR và Nhãn năng lượng trước khi bán ra thị trường." }
        ]
      },
      {
        id: "led",
        name: "Đèn LED",
        group: "Gia dụng & Năng lượng",
        scope: "Đèn LED có balats lắp liền (E27, B22..), Đèn LED 2 đầu, Đèn điện LED. P < 60W, U < 250V.",
        ministries: ["BỘ KHCN", "BỘ CÔNG THƯƠNG"],
        standards: [
          { field: "An toàn & EMC", code: "QCVN 19:2019/BKHCN", note: "Bắt buộc Hợp quy" },
          { field: "Hiệu suất năng lượng", code: "TCVN 11844:2017", note: "Dán nhãn năng lượng" },
          { field: "Tuổi thọ", code: "QCVN 19:2019", note: "Thử nghiệm tuổi thọ" }
        ],
        steps: [
          { phase: "Bước 1: Thử nghiệm", desc: "Thử nghiệm theo QCVN 19 (Safety + EMC) và HSNL." },
          { phase: "Bước 2: Chứng nhận", desc: "Đánh giá chứng nhận Hợp quy (Phương thức 1 hoặc 7)." },
          { phase: "Bước 3: Công bố", desc: "Công bố Hợp quy tại Chi cục TĐC và Công bố dán nhãn tại Bộ Công Thương." }
        ]
      },
      {
        id: "microwave",
        name: "Lò vi sóng",
        group: "Gia dụng",
        scope: "Lò vi sóng dùng trong gia đình.",
        ministries: ["BỘ KHCN"],
        standards: [
          { field: "An toàn điện", code: "QCVN 4:2009/BKHCN", note: "Sửa đổi 1:2016" },
          { field: "EMC", code: "QCVN 9:2012/BKHCN", note: "Sửa đổi 1:2018" },
          { field: "Hiệu suất năng lượng", code: "TCVN 13663:2023", note: "Dự thảo lộ trình bắt buộc" }
        ],
        steps: [
          { phase: "Bước 1", desc: "Đăng ký kiểm tra chất lượng hàng nhập khẩu." },
          { phase: "Bước 2", desc: "Thử nghiệm An toàn và EMC." },
          { phase: "Bước 3", desc: "Chứng nhận hợp quy và Dán tem CR." }
        ]
      },
      {
        id: "tv",
        name: "Máy thu hình (Tivi)",
        group: "Gia dụng & Năng lượng",
        scope: "Màn hình tivi, Smart TV.",
        ministries: ["BỘ CÔNG THƯƠNG", "BỘ TTTT"],
        standards: [
          { field: "Hiệu suất năng lượng", code: "TCVN 9536:2021", note: "Dán nhãn năng lượng" },
          { field: "DVB-T2", code: "QCVN 63:2012/BTTTT", note: "Tích hợp đầu thu số" },
          { field: "Wifi/BT", code: "QCVN 54, 65", note: "Nếu có kết nối mạng" }
        ],
        steps: [
          { phase: "Quy trình", desc: "Thử nghiệm HSNL & Tích hợp DVB-T2 -> Công bố dán nhãn -> Công bố hợp quy (cho phần thu phát sóng)." }
        ]
      }
    ];

    // COMPONENTS
    const ProcedureCard = ({ item }) => {
      const [isOpen, setIsOpen] = useState(false);

      return html`
        <div className="bg-white rounded-xl border border-slate-200 shadow-sm hover:shadow-md transition-all mb-4 overflow-hidden animate-fadeIn">
          <div 
            className="p-5 flex items-center justify-between cursor-pointer bg-slate-50/50"
            onClick=${() => setIsOpen(!isOpen)}
          >
            <div className="flex items-center gap-4">
              <div className=${`w-12 h-12 rounded-full flex items-center justify-center text-white shadow-sm ${item.group.includes('CNTT') ? 'bg-blue-600' : 'bg-green-600'}`}>
                ${item.group.includes('CNTT') ? html`<${Wifi} size=${24} />` : html`<${Zap} size=${24} />`}
              </div>
              <div>
                <h3 className="text-lg font-bold text-slate-800">${item.name}</h3>
                <div className="text-xs text-slate-500 font-medium flex gap-2 mt-1">
                  ${item.ministries.map(m => html`
                    <span className="bg-white border border-slate-200 px-2 py-0.5 rounded text-slate-600">${m}</span>
                  `)}
                </div>
              </div>
            </div>
            <button className="text-slate-400">
              ${isOpen ? html`<${ChevronUp} size=${20}/>` : html`<${ChevronDown} size=${20}/>`}
            </button>
          </div>

          ${isOpen && html`
            <div className="p-6 border-t border-slate-100 bg-white">
              <div className="mb-6">
                <h4 className="text-xs font-bold text-slate-400 uppercase tracking-wider mb-2 flex items-center gap-2">
                  <${Shield} size=${14}/> Phạm vi & Đối tượng
                </h4>
                <p className="text-sm text-slate-700 bg-slate-50 p-3 rounded-lg border border-slate-100">
                  ${item.scope}
                </p>
              </div>

              <div className="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div>
                  <h4 className="text-xs font-bold text-slate-400 uppercase tracking-wider mb-3 flex items-center gap-2">
                    <${BookOpen} size=${14}/> Quy chuẩn áp dụng
                  </h4>
                  <ul className="space-y-2">
                    ${item.standards.map((std, idx) => html`
                      <li key=${idx} className="flex flex-col p-2 rounded border border-slate-100 hover:border-blue-100 transition-colors">
                        <div className="flex justify-between items-start">
                          <span className="text-sm font-bold text-slate-700">${std.code}</span>
                          <span className="text-[10px] bg-blue-50 text-blue-600 px-2 py-0.5 rounded font-bold">${std.field}</span>
                        </div>
                        <span className="text-xs text-slate-500 mt-1 italic">${std.note}</span>
                      </li>
                    `)}
                  </ul>
                </div>

                <div>
                  <h4 className="text-xs font-bold text-slate-400 uppercase tracking-wider mb-3 flex items-center gap-2">
                    <${Layers} size=${14}/> Các bước thực hiện
                  </h4>
                  <div className="relative pl-4 space-y-6 step-line">
                    ${item.steps.map((step, idx) => html`
                      <div key=${idx} className="relative z-10">
                        <div className="absolute -left-[21px] top-1 w-3 h-3 rounded-full bg-blue-500 border-2 border-white shadow-sm"></div>
                        <h5 className="text-sm font-bold text-blue-900">${step.phase}</h5>
                        <p className="text-sm text-slate-600 mt-1 leading-relaxed">${step.desc}</p>
                      </div>
                    `)}
                  </div>
                </div>
              </div>

              <div className="mt-6 pt-4 border-t border-slate-100 flex items-center gap-2 text-xs text-amber-600 bg-amber-50 p-3 rounded-lg">
                <${AlertTriangle} size=${16} />
                <span>Lưu ý: Quy trình có thể thay đổi tùy theo hình thức nhập khẩu (Lô hàng) hoặc Sản xuất trong nước (3 năm). Liên hệ PGL để được tư vấn chính xác.</span>
              </div>
            </div>
          `}
        </div>
      `;
    };

    const App = () => {
      const [query, setQuery] = useState('');

      const filtered = useMemo(() => {
        if (!query) return PROCEDURES;
        const lower = query.toLowerCase();
        return PROCEDURES.filter(p => 
          p.name.toLowerCase().includes(lower) || 
          p.standards.some(s => s.code.toLowerCase().includes(lower))
        );
      }, [query]);

      return html`
        <div className="min-h-screen flex flex-col md:flex-row">
          <aside className="w-full md:w-80 bg-white border-r border-slate-200 p-6 hidden md:block">
            <div className="flex items-center gap-3 mb-8">
              <div className="bg-blue-600 p-2.5 rounded-xl text-white shadow-lg shadow-blue-200">
                <${FileText} size=${28} />
              </div>
              <div>
                <h1 className="font-bold text-xl text-slate-800">PGL Proc</h1>
                <p className="text-xs text-slate-500">Tra cứu thủ tục v2.0</p>
              </div>
            </div>
            
            <div className="space-y-6">
              <div className="p-4 bg-blue-50 rounded-xl border border-blue-100">
                <h3 className="font-bold text-blue-800 text-sm mb-2">Hướng dẫn</h3>
                <p className="text-xs text-blue-600 leading-relaxed">
                  Nhập tên sản phẩm hoặc mã quy chuẩn để xem chi tiết:
                  <ul className="list-disc ml-4 mt-2 space-y-1">
                    <li>Quy chuẩn áp dụng</li>
                    <li>Lộ trình thực hiện</li>
                    <li>Cơ quan quản lý</li>
                  </ul>
                </p>
              </div>

              <div>
                <h3 className="font-bold text-slate-700 text-sm mb-3">Phân loại quản lý</h3>
                <div className="space-y-2 text-sm">
                  <div className="flex items-center gap-2">
                    <span className="w-3 h-3 rounded-full bg-blue-500"></span>
                    <span className="text-slate-600">Bộ TTTT (MIC) - Tem ICT</span>
                  </div>
                  <div className="flex items-center gap-2">
                    <span className="w-3 h-3 rounded-full bg-green-500"></span>
                    <span className="text-slate-600">Bộ Công Thương (MOIT) - Nhãn NL</span>
                  </div>
                  <div className="flex items-center gap-2">
                    <span className="w-3 h-3 rounded-full bg-pink-500"></span>
                    <span className="text-slate-600">Bộ KHCN (MOST) - Tem CR</span>
                  </div>
                </div>
              </div>
            </div>
          </aside>

          <main className="flex-1 bg-slate-50/50 p-4 md:p-8 h-screen overflow-y-auto">
            <div className="max-w-4xl mx-auto">
              <div className="mb-8">
                <h2 className="text-2xl font-extrabold text-slate-800 mb-2">Tra cứu Thủ tục Hợp quy</h2>
                <p className="text-slate-500">Dữ liệu cập nhật mới nhất 2026 cho thiết bị Điện, Điện tử & Viễn thông</p>
              </div>

              <div className="relative mb-6 group">
                <${Search} className="absolute left-4 top-1/2 -translate-y-1/2 text-slate-400 group-focus-within:text-blue-500 transition-colors" size=${20} />
                <input 
                  type="text" 
                  className="w-full pl-12 pr-4 py-4 bg-white border border-slate-200 rounded-xl shadow-sm focus:outline-none focus:ring-4 focus:ring-blue-50 focus:border-blue-500 transition-all text-lg"
                  placeholder="Ví dụ: Laptop, Điều hòa, QCVN 132..."
                  value=${query}
                  onChange=${(e) => setQuery(e.target.value)}
                  autoFocus
                />
              </div>

              <div>
                <div className="text-xs font-bold text-slate-400 uppercase tracking-wider mb-4">
                  Kết quả tìm kiếm (${filtered.length})
                </div>
                
                ${filtered.length > 0 ? filtered.map(item => html`
                  <${ProcedureCard} key=${item.id} item=${item} />
                `) : html`
                  <div className="text-center py-12">
                    <div className="bg-white p-4 rounded-full inline-block shadow-sm mb-3">
                      <${Search} size=${32} className="text-slate-300" />
                    </div>
                    <p className="text-slate-500 font-medium">Không tìm thấy thủ tục phù hợp</p>
                  </div>
                `}
              </div>
            </div>
          </main>
        </div>
      `;
    };

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(html`<${App} />`);
  </script>
</body>
</html>
